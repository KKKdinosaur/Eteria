<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì¥ë¹„ ì˜µì…˜ í…Œì´ë¸”</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            background: #f5f5f5;
            padding: 40px 20px;
            min-height: 100vh;
            color: #1a1a1a;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            color: #1a1a1a;
            margin-bottom: 40px;
            font-size: 2.2em;
            font-weight: 700;
            letter-spacing: -0.5px;
        }

        .grid-layout {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 24px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            border-radius: 12px;
            padding: 32px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            border: 1px solid #e8e8e8;
        }

        .card h2 {
            color: #1a1a1a;
            margin-bottom: 24px;
            font-size: 1.6em;
            font-weight: 700;
            letter-spacing: -0.4px;
            padding-bottom: 12px;
            border-bottom: 2px solid #1a1a1a;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th {
            background: #f9f9f9;
            color: #333;
            padding: 14px 18px;
            text-align: left;
            font-weight: 700;
            font-size: 13px;
            border-bottom: 2px solid #e0e0e0;
            letter-spacing: 0.3px;
        }

        td {
            padding: 16px 18px;
            border-bottom: 1px solid #f0f0f0;
            font-size: 14.5px;
            color: #2a2a2a;
            line-height: 1.6;
        }

        tr:last-child td {
            border-bottom: none;
        }

        tbody tr:hover {
            background: #fafafa;
        }

        .equipment-name {
            font-weight: 700;
            font-size: 15px;
            color: #1a1a1a;
            min-width: 100px;
        }

        .color-badge {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 12.5px;
            margin-right: 8px;
            letter-spacing: -0.2px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .color-badge:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        .color-badge.active {
            box-shadow: 0 0 0 3px rgba(0,0,0,0.1);
            transform: scale(1.05);
        }

        .color-red { 
            background: #fee; 
            color: #c00; 
            border: 1px solid #fcc;
        }
        .color-blue { 
            background: #e3f2fd; 
            color: #1565c0; 
            border: 1px solid #bbdefb;
        }
        .color-yellow { 
            background: #fff9e6; 
            color: #b8860b; 
            border: 1px solid #ffe9a8;
        }
        .color-green { 
            background: #e8f5e9; 
            color: #2e7d32; 
            border: 1px solid #c8e6c9;
        }

        .section-divider {
            font-weight: 600;
            color: #666;
            margin: 0 6px;
        }

        /* ìƒ‰ìƒë³„ ì„¹ì…˜ í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
        .color-section-table td:first-child {
            font-weight: 600;
        }

        .color-section-table td {
            text-align: center;
            padding: 14px 12px;
        }

        .color-section-table td:first-child {
            text-align: left;
        }

        .color-section-table th {
            text-align: center;
            font-size: 12px;
        }

        .color-section-table th:first-child {
            text-align: left;
        }

        /* ìƒ‰ìƒ ì„ íƒ ë²„íŠ¼ */
        .color-selector {
            display: flex;
            gap: 12px;
            margin-bottom: 24px;
            flex-wrap: wrap;
        }

        .color-selector .color-badge {
            padding: 8px 16px;
            font-size: 14px;
        }

        /* ë¶€ì˜µì…˜ ìƒíƒœ ìŠ¤íƒ€ì¼ */
        .sub-option-item {
            display: inline-block;
            padding: 6px 14px;
            margin: 3px;
            border-radius: 6px;
            font-size: 15px;
            transition: all 0.3s;
            font-weight: 500;
            cursor: pointer;
            user-select: none;
        }

        .sub-option-item:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 6px rgba(0,0,0,0.15);
        }

        .sub-option-item:active {
            transform: translateY(0);
        }

        .sub-option-item.good {
            background: #e8f5e9;
            color: #2e7d32;
            border: 1px solid #c8e6c9;
            font-weight: 600;
        }

        .sub-option-item.bad {
            background: #ffebee;
            color: #c62828;
            border: 1px solid #ffcdd2;
            opacity: 0.7;
        }



        /* ë°˜ì‘í˜• */
        @media (max-width: 1200px) {
            .grid-layout {
                grid-template-columns: 1fr;
            }
        }

        /* ì£¼ìš” ë¶€ì˜µì…˜ ìŠ¤íƒ€ì¼ */
        .sub-options {
            color: #555;
            font-size: 13.5px;
            letter-spacing: 0.2px;
        }

        /* ì˜µì…˜ ë¶„ì„ê¸° ìŠ¤íƒ€ì¼ */
        .option-analyzer {
            margin-top: 24px;
        }

        .main-option-select {
            margin-bottom: 20px;
        }

        .main-option-select label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: #1a1a1a;
        }

        .main-option-select select {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 15px;
            background: white;
            cursor: pointer;
            transition: border-color 0.2s;
        }

        .main-option-select select:focus {
            outline: none;
            border-color: #1a1a1a;
        }

        .sub-options-display {
            line-height: 2;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ê°€ë°© ì¿ ì™€ì•™</h1>
        
        <div class="grid-layout">
            <!-- ì¥ë¹„ ì˜µì…˜ (ì¢Œì¸¡, ë„“ê²Œ) -->
            <div class="card">
                <h2>ì¥ë¹„ ì˜µì…˜</h2>
                <table>
                    <thead>
                        <tr>
                            <th style="width: 110px;">ì¥ë¹„</th>
                            <th style="width: 200px;">ì£¼ìš” ë¶€ì˜µì…˜</th>
                            <th>íŒë§¤ ì˜µì…˜ (ìƒ‰ìƒë³„)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="equipment-name">ë§ˆìŠ¤í¬</td>
                            <td class="sub-options">ì¹˜í™• / ì¹˜í”¼ / ê³µ% / ì†ë„<br>íš¨ëª… / ê¹¡ë°© / ê¹¡ì²´</td>
                            <td>
                                <span class="color-badge color-red">ë¹¨ê°•</span> ê¹¡ë°©/ê¹¡ì²´
                                <span class="section-divider">|</span>
                                <span class="color-badge color-blue">íŒŒë‘</span> ê¹¡ë°©/ê¹¡ì²´/ì†X
                                <span class="section-divider">|</span>
                                <span class="color-badge color-yellow">ë…¸ë‘</span> ê³µ%
                                <span class="section-divider">|</span>
                                <span class="color-badge color-green">ì´ˆë¡</span> ê¹¡ê³µ
                            </td>
                        </tr>
                        <tr>
                            <td class="equipment-name">íŠ¸ëœì§€ìŠ¤í„°</td>
                            <td class="sub-options">ì¹˜í™• / ì¹˜í”¼ / ì†ë„ / ì²´%<br>ê¹¡ë°© / íš¨ì € / ê¹¡ê³µ</td>
                            <td>
                                <span class="color-badge color-red">ë¹¨ê°•</span> íš¨ì €/ê¹¡ë°©
                                <span class="section-divider">|</span>
                                <span class="color-badge color-blue">íŒŒë‘</span> íš¨ì €/ê¹¡ê³µ/ì†X
                                <span class="section-divider">|</span>
                                <span class="color-badge color-yellow">ë…¸ë‘</span> ê¹¡ê³µ
                                <span class="section-divider">|</span>
                                <span class="color-badge color-green">ì´ˆë¡</span> ê¹¡ê³µ/ì¹˜í”¼
                            </td>
                        </tr>
                        <tr>
                            <td class="equipment-name">ë¦¬ìŠ¤íŠ¸</td>
                            <td class="sub-options">ì¹˜í™• / ì¹˜í”¼ / ì†ë„ / ë°©%<br>ê¹¡ì²´ / íš¨ì € / ê¹¡ê³µ</td>
                            <td>
                                <span class="color-badge color-red">ë¹¨ê°•</span> íš¨ì €/ê¹¡ê³µ
                                <span class="section-divider">|</span>
                                <span class="color-badge color-blue">íŒŒë‘</span> íš¨ì €/ê¹¡ê³µ/ì†X
                                <span class="section-divider">|</span>
                                <span class="color-badge color-yellow">ë…¸ë‘</span> ê¹¡ê³µ
                                <span class="section-divider">|</span>
                                <span class="color-badge color-green">ì´ˆë¡</span> ê¹¡ê³µ
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- ìƒ‰ìƒë³„ ì„¹ì…˜ (ìš°ì¸¡ ìƒë‹¨) -->
            <div class="card">
                <h2>ìƒ‰ìƒë³„ ì„¹ì…˜</h2>
                <table class="color-section-table">
                    <thead>
                        <tr>
                            <th>ìƒ‰ìƒ</th>
                            <th></th>
                            <th></th>
                            <th></th>
                            <th></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><span class="color-badge color-red">ë¹¨ê°•</span></td>
                            <td>ê³µì„¸</td>
                            <td>ì²˜ë‹¨</td>
                            <td>ê´‘í­</td>
                            <td>ê¸°ì„¸<br>ì¶”ê²©</td>
                        </tr>
                        <tr>
                            <td><span class="color-badge color-blue">íŒŒë‘</span></td>
                            <td>ì§ˆì£¼</td>
                            <td>ìˆ˜í˜¸</td>
                            <td>ì§„ê²©</td>
                            <td>ì‹œê³µ<br>ì§€ë°°</td>
                        </tr>
                        <tr>
                            <td><span class="color-badge color-yellow">ë…¸ë‘</span></td>
                            <td>ê°•ì² </td>
                            <td>ì•…ê¸°</td>
                            <td>ìœ í˜ˆ</td>
                            <td>-</td>
                        </tr>
                        <tr>
                            <td><span class="color-badge color-green">ì´ˆë¡</span></td>
                            <td>ì›ì²œ</td>
                            <td>ì¹˜ìœ </td>
                            <td>-</td>
                            <td>-</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- ì˜¤ë¥¸ìª½ ëª¨ë“ˆ (ì¥ë¹„ ì˜µì…˜ ì•„ë˜) -->
        <div class="card">
            <h2>ì˜¤ë¥¸ìª½ ëª¨ë“ˆ</h2>
            
            <div class="color-selector">
                <span class="color-badge color-red" data-color="red">ë¹¨ê°•</span>
                <span class="color-badge color-blue" data-color="blue">íŒŒë‘</span>
                <span class="color-badge color-yellow" data-color="yellow">ë…¸ë‘</span>
                <span class="color-badge color-green" data-color="green">ì´ˆë¡</span>
            </div>

            <div class="option-analyzer">
                <div class="main-option-select">
                    <label>ì£¼ ì˜µì…˜ ì„ íƒ</label>
                    <select id="mainOptionSelect">
                        <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                        <option value="HP%">HP%</option>
                        <option value="ì¹˜ëª…íƒ€ í™•ë¥ ">ì¹˜ëª…íƒ€ í™•ë¥ </option>
                        <option value="ì¹˜ëª…íƒ€ í”¼í•´">ì¹˜ëª…íƒ€ í”¼í•´</option>
                        <option value="ê³µ%">ê³µ%</option>
                        <option value="ë°©%">ë°©%</option>
                        <option value="íš¨ê³¼ ëª…ì¤‘">íš¨ê³¼ ëª…ì¤‘</option>
                        <option value="íš¨ê³¼ ì €í•­">íš¨ê³¼ ì €í•­</option>
                        <option value="ê¹¡ì²´">ê¹¡ì²´</option>
                    </select>
                </div>

                <div class="sub-options-display" id="subOptionsDisplay">
                    ìƒ‰ìƒê³¼ ì£¼ ì˜µì…˜ì„ ì„ íƒí•˜ì„¸ìš”
                </div>
            </div>
        </div>


    </div>

    <script>
        // ì£¼ ì˜µì…˜ë³„ ë¶€ì˜µì…˜ ë°ì´í„°
        const mainOptionData = {
            'HP%': ['ê¹¡ì²´', 'ê³µ%', 'ê¹¡ê³µ', 'ë°©%', 'ê¹¡ë°©', 'ì¹˜ëª…íƒ€ í™•ë¥ ', 'ì¹˜ëª…íƒ€ í”¼í•´', 'íš¨ê³¼ ëª…ì¤‘', 'íš¨ê³¼ ì €í•­', 'ê³µì†'],
            'ì¹˜ëª…íƒ€ í™•ë¥ ': ['HP%', 'ê¹¡ì²´', 'ê³µ%', 'ê¹¡ê³µ', 'ë°©%', 'ê¹¡ë°©', 'ì¹˜ëª…íƒ€ í”¼í•´', 'íš¨ê³¼ ëª…ì¤‘', 'íš¨ê³¼ ì €í•­', 'ê³µì†'],
            'ì¹˜ëª…íƒ€ í”¼í•´': ['HP%', 'ê¹¡ì²´', 'ê³µ%', 'ê¹¡ê³µ', 'ë°©%', 'ê¹¡ë°©', 'ì¹˜ëª…íƒ€ í™•ë¥ ', 'íš¨ê³¼ ëª…ì¤‘', 'íš¨ê³¼ ì €í•­', 'ê³µì†'],
            'ê³µ%': ['HP%', 'ê¹¡ì²´', 'ê¹¡ê³µ', 'ë°©%', 'ê¹¡ë°©', 'ì¹˜ëª…íƒ€ í™•ë¥ ', 'ì¹˜ëª…íƒ€ í”¼í•´', 'íš¨ê³¼ ëª…ì¤‘', 'íš¨ê³¼ ì €í•­', 'ê³µì†'],
            'ë°©%': ['HP%', 'ê¹¡ì²´', 'ê³µ%', 'ê¹¡ê³µ', 'ê¹¡ë°©', 'ì¹˜ëª…íƒ€ í™•ë¥ ', 'ì¹˜ëª…íƒ€ í”¼í•´', 'íš¨ê³¼ ëª…ì¤‘', 'íš¨ê³¼ ì €í•­', 'ê³µì†'],
            'íš¨ê³¼ ëª…ì¤‘': ['HP%', 'ê¹¡ì²´', 'ê³µ%', 'ê¹¡ê³µ', 'ë°©%', 'ê¹¡ë°©', 'ì¹˜ëª…íƒ€ í™•ë¥ ', 'ì¹˜ëª…íƒ€ í”¼í•´', 'íš¨ê³¼ ì €í•­', 'ê³µì†'],
            'íš¨ê³¼ ì €í•­': ['HP%', 'ê¹¡ì²´', 'ê³µ%', 'ê¹¡ê³µ', 'ë°©%', 'ê¹¡ë°©', 'ì¹˜ëª…íƒ€ í™•ë¥ ', 'ì¹˜ëª…íƒ€ í”¼í•´', 'íš¨ê³¼ ëª…ì¤‘', 'ê³µì†'],
            'ê¹¡ì²´': ['HP%', 'ê³µ%', 'ê¹¡ê³µ', 'ë°©%', 'ê¹¡ë°©', 'ì¹˜ëª…íƒ€ í™•ë¥ ', 'ì¹˜ëª…íƒ€ í”¼í•´', 'íš¨ê³¼ ëª…ì¤‘', 'íš¨ê³¼ ì €í•­', 'ê³µì†']
        };

        // ì£¼ ì˜µì…˜ë³„ ìœ íš¨ ì˜µì…˜ ì •ì˜ (ìƒ‰ìƒ ë¬´ê´€) - ì‚¬ìš© ì•ˆ í•¨
        // const mainOptionValidOptions = {
        //     'HP%': ['ê¹¡ì²´', 'ì¹˜ëª…íƒ€ í™•ë¥ ', 'ì¹˜ëª…íƒ€ í”¼í•´', 'íš¨ê³¼ ëª…ì¤‘', 'íš¨ê³¼ ì €í•­', 'ê³µì†', 'ë°©%']
        // };

        // ìƒ‰ìƒë³„ ì¢‹ì€ ì˜µì…˜ ì •ì˜ (ê¸°ë³¸ê°’)
        const defaultColorGoodOptions = {
            'red': {
                'HP%': ['ì¹˜ëª…íƒ€ í™•ë¥ ', 'ì¹˜ëª…íƒ€ í”¼í•´', 'ê³µì†'],
                'ì¹˜ëª…íƒ€ í™•ë¥ ': ['HP%', 'ì¹˜ëª…íƒ€ í”¼í•´', 'ê³µ%', 'ê¹¡ê³µ', 'ê³µì†'],
                'ì¹˜ëª…íƒ€ í”¼í•´': ['HP%', 'ì¹˜ëª…íƒ€ í™•ë¥ ', 'ê³µ%', 'ê¹¡ê³µ', 'ê³µì†'],
                'ê³µ%': ['ì¹˜ëª…íƒ€ í™•ë¥ ', 'ì¹˜ëª…íƒ€ í”¼í•´', 'ê¹¡ê³µ', 'ê³µì†'],
                'ë°©%': ['ê¹¡ì²´', 'ê¹¡ë°©'],
                'íš¨ê³¼ ëª…ì¤‘': ['ê³µ%', 'ê¹¡ê³µ', 'ê³µì†'],
                'íš¨ê³¼ ì €í•­': ['HP%', 'ê¹¡ì²´', 'ë°©%', 'ê¹¡ë°©'],
                'ê¹¡ì²´': ['HP%', 'ë°©%', 'ê¹¡ë°©']
            },
            'blue': {
                'HP%': ['ê¹¡ì²´', 'ë°©%', 'íš¨ê³¼ ì €í•­'],
                'ì¹˜ëª…íƒ€ í™•ë¥ ': ['HP%', 'ê¹¡ì²´', 'ë°©%', 'ê¹¡ë°©', 'íš¨ê³¼ ì €í•­'],
                'ì¹˜ëª…íƒ€ í”¼í•´': ['HP%', 'ê¹¡ì²´', 'ë°©%', 'ê¹¡ë°©', 'íš¨ê³¼ ì €í•­'],
                'ê³µ%': ['HP%', 'ê¹¡ì²´', 'ë°©%', 'ê¹¡ë°©', 'íš¨ê³¼ ì €í•­'],
                'ë°©%': ['HP%', 'ê¹¡ì²´', 'ê¹¡ë°©', 'íš¨ê³¼ ì €í•­'],
                'íš¨ê³¼ ëª…ì¤‘': ['HP%', 'ê¹¡ì²´', 'ë°©%', 'ê¹¡ë°©', 'íš¨ê³¼ ì €í•­'],
                'íš¨ê³¼ ì €í•­': ['HP%', 'ê¹¡ì²´', 'ë°©%', 'ê¹¡ë°©'],
                'ê¹¡ì²´': ['HP%', 'ë°©%', 'ê¹¡ë°©', 'íš¨ê³¼ ì €í•­']
            },
            'yellow': {
                'HP%': ['ê¹¡ì²´', 'ë°©%'],
                'ì¹˜ëª…íƒ€ í™•ë¥ ': ['HP%', 'ê¹¡ì²´', 'ë°©%', 'ê¹¡ë°©'],
                'ì¹˜ëª…íƒ€ í”¼í•´': ['HP%', 'ê¹¡ì²´', 'ë°©%', 'ê¹¡ë°©'],
                'ê³µ%': ['HP%', 'ê¹¡ì²´', 'ë°©%', 'ê¹¡ë°©'],
                'ë°©%': ['HP%', 'ê¹¡ì²´', 'ê¹¡ë°©'],
                'íš¨ê³¼ ëª…ì¤‘': ['HP%', 'ê¹¡ì²´', 'ë°©%', 'ê¹¡ë°©'],
                'íš¨ê³¼ ì €í•­': ['HP%', 'ê¹¡ì²´', 'ë°©%', 'ê¹¡ë°©'],
                'ê¹¡ì²´': ['HP%', 'ë°©%', 'ê¹¡ë°©']
            },
            'green': {
                'HP%': ['íš¨ê³¼ ëª…ì¤‘', 'íš¨ê³¼ ì €í•­'],
                'ì¹˜ëª…íƒ€ í™•ë¥ ': ['HP%', 'íš¨ê³¼ ëª…ì¤‘', 'íš¨ê³¼ ì €í•­'],
                'ì¹˜ëª…íƒ€ í”¼í•´': ['HP%', 'íš¨ê³¼ ëª…ì¤‘', 'íš¨ê³¼ ì €í•­'],
                'ê³µ%': ['íš¨ê³¼ ëª…ì¤‘', 'íš¨ê³¼ ì €í•­'],
                'ë°©%': ['HP%', 'ê¹¡ì²´', 'íš¨ê³¼ ëª…ì¤‘', 'íš¨ê³¼ ì €í•­'],
                'íš¨ê³¼ ëª…ì¤‘': ['HP%', 'ê³µ%', 'ê¹¡ê³µ', 'íš¨ê³¼ ì €í•­', 'ê³µì†'],
                'íš¨ê³¼ ì €í•­': ['HP%', 'ê¹¡ì²´', 'ë°©%', 'ê¹¡ë°©', 'íš¨ê³¼ ëª…ì¤‘'],
                'ê¹¡ì²´': ['HP%', 'ë°©%', 'íš¨ê³¼ ëª…ì¤‘', 'íš¨ê³¼ ì €í•­']
            }
        };

        let selectedColor = null;
        let selectedMainOption = null;
        let customColorOptions = {}; // ì‚¬ìš©ì ì •ì˜ ìƒ‰ìƒë³„ ì˜µì…˜
        let pollInterval = null; // í´ë§ ì¸í„°ë²Œ

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì €ì¥ëœ ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸°
        function loadCustomOptions() {
            console.log('ğŸ”„ ì„¤ì • ë¡œë“œ ì‹œì‘...');
            try {
                const savedData = localStorage.getItem('custom-color-options');
                console.log('ë¡œë“œ ê²°ê³¼:', savedData);
                
                if (savedData) {
                    customColorOptions = JSON.parse(savedData);
                    console.log('âœ… ì»¤ìŠ¤í…€ ì˜µì…˜ ë¡œë“œ ì™„ë£Œ:', customColorOptions);
                } else {
                    // ì €ì¥ëœ ê°’ì´ ì—†ìœ¼ë©´ ê¸°ë³¸ê°’ìœ¼ë¡œ ì´ˆê¸°í™”í•˜ê³  ì €ì¥
                    console.log('âš ï¸ ì €ì¥ëœ ì„¤ì • ì—†ìŒ, ê¸°ë³¸ê°’ ì‚¬ìš©');
                    customColorOptions = JSON.parse(JSON.stringify(defaultColorGoodOptions));
                    saveCustomOptions();
                }
            } catch (error) {
                console.log('âŒ ì €ì¥ëœ ì„¤ì • ë¡œë“œ ì‹¤íŒ¨:', error);
                customColorOptions = JSON.parse(JSON.stringify(defaultColorGoodOptions));
                saveCustomOptions();
            }
            updateSubOptions();
        }

        // ì£¼ê¸°ì ìœ¼ë¡œ ë³€ê²½ì‚¬í•­ í™•ì¸ (5ì´ˆë§ˆë‹¤)
        function startPolling() {
            if (pollInterval) clearInterval(pollInterval);
            
            pollInterval = setInterval(() => {
                try {
                    const savedData = localStorage.getItem('custom-color-options');
                    if (savedData) {
                        const newOptions = JSON.parse(savedData);
                        // ë³€ê²½ì‚¬í•­ì´ ìˆìœ¼ë©´ ì—…ë°ì´íŠ¸
                        if (JSON.stringify(newOptions) !== JSON.stringify(customColorOptions)) {
                            customColorOptions = newOptions;
                            updateSubOptions();
                            console.log('ë‹¤ë¥¸ ì‚¬ìš©ìì˜ ë³€ê²½ì‚¬í•­ ë°˜ì˜ë¨');
                        }
                    }
                } catch (error) {
                    console.log('í´ë§ ì—ëŸ¬:', error);
                }
            }, 5000);
        }

        // ì»¤ìŠ¤í…€ ì˜µì…˜ ì €ì¥
        function saveCustomOptions() {
            try {
                console.log('ì €ì¥ ì‹œë„ ì¤‘...', customColorOptions);
                const jsonString = JSON.stringify(customColorOptions);
                console.log('JSON ë¬¸ìì—´:', jsonString);
                
                localStorage.setItem('custom-color-options', jsonString);
                console.log('âœ… ì»¤ìŠ¤í…€ ì˜µì…˜ ì €ì¥ ì™„ë£Œ (localStorage)');
                return true;
            } catch (error) {
                console.error('âŒ ì €ì¥ ì‹¤íŒ¨:', error);
                return false;
            }
        }

        // í˜„ì¬ ìƒ‰ìƒë³„ ì¢‹ì€ ì˜µì…˜ ê°€ì ¸ì˜¤ê¸°
        function getColorGoodOptions(color) {
            if (customColorOptions[color] && customColorOptions[color][selectedMainOption]) {
                return customColorOptions[color][selectedMainOption];
            }
            if (defaultColorGoodOptions[color] && defaultColorGoodOptions[color][selectedMainOption]) {
                return defaultColorGoodOptions[color][selectedMainOption];
            }
            return [];
        }

        // ìƒ‰ìƒ ì„ íƒ ì´ë²¤íŠ¸
        document.querySelectorAll('.color-badge').forEach(badge => {
            badge.addEventListener('click', function() {
                const color = this.getAttribute('data-color');
                if (!color) return;

                // í™œì„±í™” ìƒíƒœ í† ê¸€
                document.querySelectorAll('.color-badge[data-color]').forEach(b => {
                    b.classList.remove('active');
                });
                this.classList.add('active');
                
                selectedColor = color;
                updateSubOptions();
            });
        });

        // ì£¼ ì˜µì…˜ ì„ íƒ ì´ë²¤íŠ¸
        document.getElementById('mainOptionSelect').addEventListener('change', function() {
            selectedMainOption = this.value;
            updateSubOptions();
        });

        // ë¶€ì˜µì…˜ í´ë¦­ ì´ë²¤íŠ¸ (í† ê¸€)
        function toggleOption(optionName) {
            console.log(`ğŸ–±ï¸ ${optionName} í´ë¦­ë¨`);
            
            if (!selectedColor || !selectedMainOption) {
                console.log('âŒ ìƒ‰ìƒ ë˜ëŠ” ì£¼ì˜µì…˜ ë¯¸ì„ íƒ');
                return;
            }

            // í˜„ì¬ ìƒ‰ìƒì˜ ì»¤ìŠ¤í…€ ì˜µì…˜ ê°ì²´ ì´ˆê¸°í™”
            if (!customColorOptions[selectedColor]) {
                customColorOptions[selectedColor] = {};
            }
            
            // í˜„ì¬ ì£¼ì˜µì…˜ì˜ ë°°ì—´ ì´ˆê¸°í™”
            if (!customColorOptions[selectedColor][selectedMainOption]) {
                if (defaultColorGoodOptions[selectedColor] && defaultColorGoodOptions[selectedColor][selectedMainOption]) {
                    customColorOptions[selectedColor][selectedMainOption] = [...defaultColorGoodOptions[selectedColor][selectedMainOption]];
                } else {
                    customColorOptions[selectedColor][selectedMainOption] = [];
                }
            }

            const currentOptions = customColorOptions[selectedColor][selectedMainOption];
            const index = currentOptions.indexOf(optionName);

            if (index > -1) {
                // ì´ë¯¸ ìˆìœ¼ë©´ ì œê±° (ë¹¨ê°„ìƒ‰ìœ¼ë¡œ ë³€ê²½)
                currentOptions.splice(index, 1);
                console.log(`ğŸ”´ ${optionName}ë¥¼ ì¢‹ì€ ì˜µì…˜ì—ì„œ ì œê±°`);
            } else {
                // ì—†ìœ¼ë©´ ì¶”ê°€ (ë…¹ìƒ‰ìœ¼ë¡œ ë³€ê²½)
                currentOptions.push(optionName);
                console.log(`ğŸŸ¢ ${optionName}ë¥¼ ì¢‹ì€ ì˜µì…˜ì— ì¶”ê°€`);
            }

            // í™”ë©´ ë¨¼ì € ì—…ë°ì´íŠ¸
            updateSubOptions();
            
            // ì €ì¥ì€ ë¹„ë™ê¸°ë¡œ
            console.log('ğŸ’¾ ì €ì¥ ì‹œì‘...');
            const saved = saveCustomOptions();
            if (saved) {
                console.log(`âœ… í† ê¸€ ì™„ë£Œ: ${selectedColor} / ${selectedMainOption} / ${optionName}`);
                console.log('í˜„ì¬ ì¢‹ì€ ì˜µì…˜:', currentOptions);
            } else {
                console.error('âŒ ì €ì¥ ì‹¤íŒ¨');
            }
        }

        // ë¶€ì˜µì…˜ í‘œì‹œ ì—…ë°ì´íŠ¸
        function updateSubOptions() {
            const display = document.getElementById('subOptionsDisplay');
            
            if (!selectedColor) {
                display.innerHTML = 'ìƒ‰ìƒì„ ì„ íƒí•˜ì„¸ìš”';
                return;
            }
            
            if (!selectedMainOption) {
                display.innerHTML = 'ì£¼ ì˜µì…˜ì„ ì„ íƒí•˜ì„¸ìš”';
                return;
            }

            const subOptions = mainOptionData[selectedMainOption];
            const goodOptions = getColorGoodOptions(selectedColor);

            let html = '';
            subOptions.forEach(option => {
                let cssClass = 'bad'; // ê¸°ë³¸ê°’ì€ ë¹¨ê°„ìƒ‰
                
                // ì¢‹ì€ ì˜µì…˜ì¸ì§€ í™•ì¸
                if (goodOptions.includes(option)) {
                    cssClass = 'good';
                }

                html += `<span class="sub-option-item ${cssClass}" onclick="toggleOption('${option}')">${option}</span>`;
            });

            display.innerHTML = html;
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸° ë° í´ë§ ì‹œì‘
        loadCustomOptions();
        startPolling();
    </script>
</body>
</html>
